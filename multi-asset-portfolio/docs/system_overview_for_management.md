# マルチアセットポートフォリオ自動配分システム 概要説明書

**対象読者**: 経営層・マネジメント層（金融基礎知識あり）
**最終更新**: 2026年1月30日

---

## 1. システムの目的

本システムは、**複数の資産（株式ETF、債券、コモディティ等）への投資配分を自動的に決定する**ソフトウェアです。

### 従来の課題
- 人間の判断による投資配分は、感情や認知バイアスの影響を受けやすい
- 市場環境の変化に対する対応が遅れがち
- 複数の指標を同時に監視・分析することが困難

### 本システムの解決策
- **データに基づく客観的な判断**を自動で実行
- **30種類以上の市場シグナル**を常時監視
- **リスク管理を組み込んだ配分決定**を実現

---

## 2. システムの全体像

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   市場データ  ──→  分析エンジン  ──→  配分決定  ──→  出力   │
│   （価格等）       （シグナル）       （最適化）     （比率） │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

**簡単に言えば**：
1. 市場のデータを集める
2. 様々な角度から分析する
3. 最適な投資比率を計算する
4. 結果を出力する

---

## 3. 処理の流れ（5つのステップ）

### ステップ1: データ収集

**何をするか**: 投資対象の価格データを取得

```
対象例:
├── 株式ETF: SPY（米国株）、QQQ（ハイテク）、EEM（新興国）
├── 債券ETF: TLT（米国長期債）、IEF（中期債）
├── コモディティ: GLD（金）、USO（原油）
└── その他: VNQ（不動産）、XLF（金融セクター）等
```

**取得データ**: 過去15年分の日次価格データ（約3,900営業日分）

---

### ステップ2: シグナル生成（市場分析）

**何をするか**: 30種類以上の指標で市場を分析し、各資産の「魅力度スコア」を算出

#### 主要なシグナルカテゴリ

| カテゴリ | 分析内容 | 具体例 |
|---------|---------|--------|
| **モメンタム系** | 価格の勢いを測定 | 過去12ヶ月のリターンが高い資産は継続しやすい |
| **平均回帰系** | 行き過ぎた動きを検出 | 短期的に下落しすぎた資産は反発しやすい |
| **トレンド系** | 長期的な方向性を判断 | 移動平均線を上回っていれば上昇トレンド |
| **マクロ経済系** | 経済全体の状況を反映 | 金利変動、VIX（恐怖指数）等 |
| **ファンダメンタル系** | 企業の実態を分析 | インサイダー取引動向、空売り比率 |

#### 分析の例：モメンタムシグナル

```
「過去12ヶ月で最も上昇した資産は、今後も好調が続く傾向がある」
（学術研究で実証済みの現象）

例:
  SPY: 過去12ヶ月リターン +18% → 魅力度スコア: 0.75
  TLT: 過去12ヶ月リターン -5%  → 魅力度スコア: 0.25
  GLD: 過去12ヶ月リターン +12% → 魅力度スコア: 0.60
```

---

### ステップ3: 戦略評価

**何をするか**: 各シグナルの「信頼性」を検証

過去データを使って、そのシグナルが実際に利益を生んだかを検証します。

```
検証方法（ウォークフォワード検証）:

  ┌────────────────┐  ┌────────┐
  │  学習期間(2年)  │→│ 検証期間 │→ このシグナルは有効か？
  └────────────────┘  └────────┘

  過去のデータで      未知の期間で
  パターンを学習      実際に検証
```

**評価指標**:
- **シャープレシオ**: リスク対比のリターン（1.0以上が目標）
- **最大ドローダウン**: 最悪の下落率（20%以下が目標）
- **勝率**: 利益が出た期間の割合

---

### ステップ4: 資産配分の最適化

**何をするか**: リスクを考慮しながら、最適な投資比率を決定

#### 配分アルゴリズム: HRP（階層的リスクパリティ）

従来の手法（平均分散最適化）の問題点を解決した最新のアプローチです。

```
従来手法の問題:
  - 過去データに過剰適合しやすい
  - 少数の資産に偏りやすい
  - 推定誤差に敏感

HRPの特徴:
  - 資産間の「似ている度合い」でグループ化
  - グループごとにリスクを均等配分
  - 安定した配分結果を実現
```

#### 配分の制約条件

```
制約例:
  - 1つの資産に20%を超えて配分しない（集中リスク回避）
  - 現金比率は市場の恐怖指数（VIX）に連動
  - 急激な配分変更を抑制（取引コスト削減）
```

---

### ステップ5: リスク管理と出力

**何をするか**: 異常事態への対応と最終的な配分比率の出力

#### リスク管理機能

| 機能 | 内容 |
|------|------|
| **ドローダウン保護** | 損失が拡大したら自動的に現金比率を引き上げ |
| **相関ブレイク検出** | 資産間の関係性が崩れたら警告 |
| **異常検知** | 極端な配分や急激な変化を検出 |
| **フォールバック** | 異常時は安全な配分（等配分/現金）に切替 |

#### 出力例

```json
{
  "配分比率": {
    "SPY（米国株）": "15%",
    "QQQ（ハイテク）": "12%",
    "TLT（長期債）": "18%",
    "GLD（金）": "10%",
    "IEF（中期債）": "15%",
    "VNQ（不動産）": "8%",
    "その他": "22%"
  },
  "リスク指標": {
    "予想ボラティリティ": "12%",
    "相関リスク": "低"
  }
}
```

---

## 4. バックテスト（検証機能）

### 目的
過去データを使って「もしこのシステムで運用していたら、どうなっていたか」を検証

### 検証方法

```
2010年 ──────────────────────────────────────→ 2025年

  │←─ 学習期間 ─→│←検証→│
                    │←─ 学習期間 ─→│←検証→│
                                      │←─ 学習期間 ─→│←検証→│

  「未来のデータを見ない」状態で、時間を進めながら検証
  （実運用と同じ条件を再現）
```

### 検証パラメータ

| 項目 | 設定値 |
|------|--------|
| 検証期間 | 2010年〜2025年（15年間） |
| リバランス頻度 | 月次 / 週次 / 日次 |
| 初期資金 | 100万ドル |
| 取引コスト | 0.1%（往復） |
| スリッページ | 0.05% |

### 目標性能

| 指標 | 目標値 | 意味 |
|------|--------|------|
| シャープレシオ | > 0.8 | リスク1単位あたりのリターン |
| 年率リターン | > 8% | 複利での年間収益率 |
| 最大ドローダウン | < 25% | 最悪期の下落率 |

---

## 5. システムの特徴

### 5.1 学術的根拠に基づく設計

採用しているシグナルは、学術論文で有効性が実証されたものです。

| シグナル | 学術的根拠 |
|---------|-----------|
| モメンタム | Jegadeesh & Titman (1993): 過去の勝者は将来も好調 |
| 52週高値 | George & Hwang (2004): 高値近辺の銘柄は上昇継続 |
| 短期リバーサル | Jegadeesh (1990): 短期の下落は反発しやすい |
| リードラグ | Oxford研究: 大型株が小型株に先行する |

### 5.2 高速処理

15年分のバックテストを約1分で完了（従来手法比 50〜100倍高速）

```
高速化技術:
  - Numba JIT: 数値計算を機械語に変換
  - 並列処理: 複数CPUコアを同時活用
  - キャッシュ: 計算結果を再利用
```

### 5.3 中断・再開機能

長時間の検証処理も、途中で中断して後から再開可能

```
10リバランスごとにチェックポイントを保存
→ 停電やシステム障害があっても、途中から再開可能
```

---

## 6. 運用イメージ

### 日次運用フロー

```
毎営業日 朝:
  1. 最新の市場データを取得
  2. シグナル分析を実行
  3. 推奨配分比率を算出
  4. 前日比の変更点をレポート出力

リバランス日（月初等）:
  5. 実際の売買注文を生成
  6. 取引コストを考慮した最適執行
```

### 出力レポート例

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  ポートフォリオ日次レポート  2026年1月30日
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

■ 推奨配分変更
  SPY: 15% → 18% (+3%)  理由: モメンタム強化
  TLT: 20% → 15% (-5%)  理由: 金利上昇リスク
  GLD: 10% → 12% (+2%)  理由: インフレヘッジ

■ リスク指標
  VIX: 18.5 (通常レベル)
  相関: 安定
  ドローダウン: -3.2% (許容範囲内)

■ 注意事項
  なし
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 7. 用語集

| 用語 | 説明 |
|------|------|
| **ETF** | 上場投資信託。株式市場で売買できる投資信託 |
| **シャープレシオ** | リスク調整後リターン。高いほど効率的 |
| **ドローダウン** | ピークからの下落率。リスクの指標 |
| **リバランス** | 配分比率を目標に戻すための売買 |
| **モメンタム** | 価格の勢い。上昇中の資産は継続しやすい傾向 |
| **ボラティリティ** | 価格変動の大きさ。リスクの指標 |
| **VIX** | 恐怖指数。市場の不安度を示す |
| **HRP** | 階層的リスクパリティ。最新の配分手法 |

---

## 8. よくある質問

### Q1: このシステムは利益を保証しますか？

**A**: いいえ、保証はできません。本システムは過去のデータに基づく統計的アプローチであり、将来の市場を予測するものではありません。ただし、感情に左右されない一貫した運用と、リスク管理機能により、長期的には人間の判断より安定した成果が期待できます。

### Q2: どの程度の頻度で配分を変更しますか？

**A**: 基本は月次リバランスを推奨します。頻繁な売買は取引コストがかさむため、明確なシグナル変化がない限り、大きな変更は行いません。

### Q3: 市場暴落時はどうなりますか？

**A**: 複数の保護機能が作動します：
- VIX上昇で自動的に現金比率を引き上げ
- ドローダウンが一定以上でリスク資産を削減
- 異常検知でフォールバック（安全配分）に切替

### Q4: 過去の検証結果は将来も再現しますか？

**A**: 過去と同じ結果を保証することはできません。ただし、以下の工夫で「過学習」（過去への過剰適合）を防いでいます：
- ウォークフォワード検証（未来を見ない検証）
- 複数シグナルの分散（単一手法への依存回避）
- パラメータの安定性フィルタ

---

## 9. まとめ

本システムは、**データと学術的根拠に基づいて投資配分を自動決定**するソフトウェアです。

**主な価値**:
1. **客観性**: 感情やバイアスを排除した判断
2. **一貫性**: 決められたルールに基づく運用
3. **効率性**: 人間では困難な多角的分析を自動化
4. **リスク管理**: 異常事態への自動対応機能

**期待される効果**:
- 長期的に安定したリスク調整後リターン
- 市場急変時の損失抑制
- 運用の属人化リスクの排除
